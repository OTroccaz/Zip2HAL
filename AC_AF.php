<?php//Autocomplete affiliationsif (isset($_GET['term'])){	$return_arr = array();	//VALID	//$reqAff = "https://api.archives-ouvertes.fr/ref/structure/?q=name_t:(".$_GET['term'].")%20AND%20valid_s:%22VALID%22&rows=1000&fl=label_s,docid,valid_s&sort=docid%20asc";	$reqAff = "https://api.archives-ouvertes.fr/ref/structure/?q=(name_t:%22".$_GET['term']."%22%20OR%20name_t:(".$_GET['term'].")%20OR%20code_t:%22".$_GET['term']."%22%20OR%20acronym_t:%22".$_GET['term']."%22%20OR%20acronym_sci:%22".$_GET['term']."%22)%20AND%20valid_s:%22VALID%22&fl=docid,valid_s,name_s,type_s,country_s,acronym_s&sort=valid_s%20desc,docid%20asc";	$reqAff = str_replace(' ', '%20', $reqAff);	$contents = file_get_contents($reqAff);	$results = json_decode($contents);	$numFound = 0;	if (isset($results->response->numFound)) {$numFound = $results->response->numFound;}		if ($numFound != 0) {		foreach($results->response->docs as $entry) {			//if ($entry->valid_s == "VALID") {$txtcolor = '#339966';}else{$txtcolor = '#ff6600';}			if (isset($entry->acronym_s)) {$acronym = " [".$entry->acronym_s."], ";}else{$acronym = ", ";}			if (isset($entry->country_s)) {$country = ", ".$entry->country_s;}else{$country = "";}			//$return_arr[] = $entry->name_s.' ('.$entry->valid_s.') ~ ('.$entry->docid.')';			$return_arr[] = $entry->docid." ~ ".$entry->name_s.$acronym.$entry->type_s.$country.' ('.$entry->valid_s.')';		}	}		//INCOMING	//$reqAff = "https://api.archives-ouvertes.fr/ref/structure/?q=name_t:(".$_GET['term'].")%20AND%20valid_s:%22INCOMING%22&rows=1000&fl=label_s,docid,valid_s&sort=docid%20asc";	$reqAff = "https://api.archives-ouvertes.fr/ref/structure/?q=(name_t:%22".$_GET['term']."%22%20OR%20name_t:(".$_GET['term'].")%20OR%20code_t:%22".$_GET['term']."%22%20OR%20acronym_t:%22".$_GET['term']."%22%20OR%20acronym_sci:%22".$_GET['term']."%22)%20AND%20valid_s:%22INCOMING%22&fl=docid,valid_s,name_s,type_s,country_s,acronym_s&sort=valid_s%20desc,docid%20asc";	$reqAff = str_replace(' ', '%20', $reqAff);	$contents = file_get_contents($reqAff);	$results = json_decode($contents);	$numFound = 0;	if (isset($results->response->numFound)) {$numFound = $results->response->numFound;}		if ($numFound != 0) {		foreach($results->response->docs as $entry) {			//if ($entry->valid_s == "VALID") {$txtcolor = '#339966';}else{$txtcolor = '#ff6600';}			if (isset($entry->acronym_s)) {$acronym = " [".$entry->acronym_s."], ";}else{$acronym = ", ";}			if (isset($entry->country_s)) {$country = ", ".$entry->country_s;}else{$country = "";}			//$return_arr[] = $entry->name_s.' ('.$entry->valid_s.') ~ ('.$entry->docid.')';			$return_arr[] = $entry->docid." ~ ".$entry->name_s.$acronym.$entry->type_s.$country.' ('.$entry->valid_s.')';		}	}		//OLD	//$reqAff = "https://api.archives-ouvertes.fr/ref/structure/?q=name_t:(".$_GET['term'].")%20AND%20valid_s:%22OLD%22&rows=1000&fl=label_s,docid,valid_s&sort=docid%20asc";	$reqAff = "https://api.archives-ouvertes.fr/ref/structure/?q=(name_t:%22".$_GET['term']."%22%20OR%20name_t:(".$_GET['term'].")%20OR%20code_t:%22".$_GET['term']."%22%20OR%20acronym_t:%22".$_GET['term']."%22%20OR%20acronym_sci:%22".$_GET['term']."%22)%20AND%20valid_s:%22OLD%22&fl=docid,valid_s,name_s,type_s,country_s,acronym_s&sort=valid_s%20desc,docid%20asc";	$reqAff = str_replace(' ', '%20', $reqAff);	$contents = file_get_contents($reqAff);	$results = json_decode($contents);	$numFound = 0;	if (isset($results->response->numFound)) {$numFound = $results->response->numFound;}		if ($numFound != 0) {		foreach($results->response->docs as $entry) {			//if ($entry->valid_s == "VALID") {$txtcolor = '#339966';}else{$txtcolor = '#ff6600';}			if (isset($entry->acronym_s)) {$acronym = " [".$entry->acronym_s."], ";}else{$acronym = ", ";}			if (isset($entry->country_s)) {$country = ", ".$entry->country_s;}else{$country = "";}			//$return_arr[] = $entry->name_s.' ('.$entry->valid_s.') ~ ('.$entry->docid.')';			$return_arr[] = $entry->docid." ~ ".$entry->name_s.$acronym.$entry->type_s.$country.' ('.$entry->valid_s.')';		}	}		echo json_encode($return_arr);}?>